#!/usr/bin/env sh

# Run credential detection script
echo "ğŸ” Checking for credentials..."
node scripts/detect-credentials.js

if [ $? -ne 0 ]; then
  echo "âŒ Credential check failed. Please remove any exposed credentials."
  exit 1
fi

# Run Prettier formatting
echo "ğŸ’… Formatting code with Prettier..."
npm run format

if [ $? -ne 0 ]; then
  echo "âŒ Prettier formatting failed."
  exit 1
fi

# Run linting with auto-fix
echo "ğŸ§¹ Running linter with auto-fix..."
npm run lint:fix || true

echo "âš ï¸  Linting completed. Any remaining issues should be addressed in future commits."

# Add any formatted/fixed files back to staging
git add .

echo "âœ… Pre-commit checks passed!"